!function(){var e="extrajs_xstore",t={};try{var r=sessionStorage.getItem(e);if(r){var n=JSON.parse(r);n&&"object"==typeof n&&(t=n)}}catch(e){console.error("extra.js: failed to load session storage state:",e)}var o=[],a=new Map,i=new WeakMap,s=!1,l=new Map,c=Object.create(null),u=new Map,f=null,d=new Map,p=new Map,v=new Map,x=new Map,h=Symbol("extraJsDirectiveDone");function m(){s||(s=!0,setTimeout(function(){s=!1;try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("extra.js: failed to save session storage state:",e)}},0))}function y(e){if("string"!=typeof e)return null;if(!(e=e.trim()))return null;var t=[],r=0,n=e.length;function o(e){return/\s/.test(e)}function a(e){return/[A-Za-z0-9_$]/.test(e)}function i(){for(;r<n&&o(e[r]);)r++}function s(){if(r>=n||!function(e){return/[A-Za-z_$]/.test(e)}(e[r]))return null;for(var t=r++;r<n&&a(e[r]);)r++;return e.slice(t,r)}i();var l=s();if(!l)return null;for(t.push(l),i();r<n;){var c=e[r];if("."===c){r++,i();var u=s();if(!u)return null;t.push(u),i()}else{if("["!==c)return null;r++,i();for(var f="";r<n&&/[0-9]/.test(e[r]);)f+=e[r++];if(i(),!f||"]"!==e[r])return null;r++,t.push(Number(f)),i()}}return t}function g(e,t){if(t&&t.length){var r,n,o=t[0];if(Object.prototype.hasOwnProperty.call(c,o)){var a=c[o];if(!a)return;a.dirty&&E(a),r=a.value,n=1}else r=e,n=0;for(;n<t.length;n++){if(null==r)return;r=r[t[n]]}return r}}function b(e){for(var t,r=[],n=new Set,o=/\(\(\s*([^()]+)\s*\)\)/g,a=0;t=o.exec(e);){t.index>a&&r.push(e.slice(a,t.index));var i=y(t[1]);i?(r.push({p:i}),n.add(i[0]+"")):r.push(t[0]),a=o.lastIndex}return a<e.length&&r.push(e.slice(a)),{t:r,k:n}}function w(e){for(var t="",r=e.t,n=0;n<r.length;n++){var o=r[n];t+="string"==typeof o?o:g(S,o.p)??""}null==e.a?e.n.nodeValue=t:e.n.setAttribute(e.a,t)}function A(e){o.push(e),e.k.forEach(function(t){var r=a.get(t);r||a.set(t,r=[]),r.push(e)}),w(e)}function j(e){var t=a.get(e);if(t)for(var r=0;r<t.length;r++)w(t[r])}function N(e){var t=l.get(e);if(t)for(var r=0;r<t.length;r++){var n=t[r],o=g(S,n.parts);if(!n.inited||o!==n.last){var a=n.last;n.last=o,n.inited=!0;try{n.fn(o,a)}catch(e){console.error("extra.js: x.watch error for path '"+n.parts.join(".")+"':",e)}}}}function E(e){var t;e.deps.forEach(function(t){var r=u.get(t);r&&(r.delete(e),r.size||u.delete(t))}),e.deps.clear(),f=e;try{t=e.fn()}catch(r){console.error("extra.js: x.computed error for '"+e.name+"':",r),t=void 0}f=null,e.value=t,e.dirty=!1}function T(e){j(e),N(e),k(e),J(e),W(e),F(e);var t=u.get(e);if(t)for(var r=Array.from(t),n=0;n<r.length;n++){var o=r[n];o.dirty=!0,E(o);var a=o.name;j(a),N(a),k(a),J(a),W(a),F(a)}}var S=function e(t,r){if(null===t||"object"!=typeof t)return t;var n=i.get(t);if(n)return n;var o=new Proxy(t,{get:function(t,n,o){if("__raw"===n)return t;var a=Reflect.get(t,n,o);if(f&&"symbol"!=typeof n){var i=r.length?r[0]:n+"";f.deps.add(i);var s=u.get(i);s||u.set(i,s=new Set),s.add(f)}return a&&"object"==typeof a?e(a,r.concat(n+"")):a},set:function(e,t,n,o){return"symbol"==typeof t?Reflect.set(e,t,n,o):(e[t]===n||(e[t]=n,m(),T(r.length?r[0]:t+"")),!0)},deleteProperty:function(e,t){return"symbol"==typeof t?Reflect.deleteProperty(e,t):!(t in e)||(delete e[t],m(),T(r.length?r[0]:t+""),!0)}});return i.set(t,o),o}(t,[]);function M(e,t){if(e){for(var r,n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);r=n.nextNode();)if(!t||!h(r)){var o=r.nodeValue;if(o&&-1!==o.indexOf("((")){var a=b(o);a.k.size&&A({n:r,a:null,t:a.t,k:a.k})}}for(var i=e.getElementsByTagName?e.getElementsByTagName("*"):[],s=0;s<i.length;s++){var l=i[s];if("SCRIPT"!==l.tagName){if(t){if(l.hasAttribute("x-if")||l.hasAttribute("x-else"))continue;if(x(l))continue}for(var c=l.attributes,u=0;u<c.length;u++){var f=c[u],d=f.value;if(d&&-1!==d.indexOf("((")){var p=b(d);p.k.size&&A({n:l,a:f.name,t:p.t,k:p.k})}}}}}function v(e){return!!(e&&e.hasAttribute&&(e.hasAttribute("x-for")||e.hasAttribute("x-if")||e.hasAttribute("x-else")))}function x(e){for(var t=e&&e.parentNode;t;){if(1===t.nodeType&&v(t))return!0;t=t.parentNode}return!1}function h(e){for(var t=e&&e.parentNode;t;){if(1===t.nodeType&&v(t))return!0;t=t.parentNode}return!1}}const O=new Map,H=Symbol("xjsRan");function L(e){if(!(e instanceof Element))return;const t=function(e){return e.getAttribute("x-js")}(e);if(!t)return;const r=t.trim();if(!r)return;let n=O.get(r);if(!n)try{n=Function("el","x","store",`\n            return (async function () {\n              with (el) {\n                ${r}\n              }\n            }).call(el);\n          `),O.set(r,n)}catch(t){return console.error("extra.js: x-js compile error on element:",e,t),void(e[H]=!0)}e[H]=!0;try{const t=n(e,window.x,S);t&&"function"==typeof t.catch&&t.catch(t=>{console.error("extra.js: x-js async error on element:",e,t)})}catch(t){console.error("extra.js: x-js runtime error on element:",e,t)}}function K(e){var t=e||document;t instanceof Element&&t.hasAttribute("x-js")&&!t[H]&&L(t),t.querySelectorAll?.("[x-js]").forEach(e=>{e[H]||L(e)})}function k(e){var t=d.get(e);if(t)for(var r=0;r<t.length;r++)C(t[r])}function C(e){var t=!!g(S,e.parts),r=t?e.ifTemplate:e.elseTemplate,n=e.currentEl||null;if(!r)return n&&n.parentNode&&n.parentNode.removeChild(n),e.currentEl=null,void(e.currentKind=null);var o=t?"if":"else";if(!n||e.currentKind!==o){n&&n.parentNode&&n.parentNode.removeChild(n);var a=r.cloneNode(!0);e.currentKind=o,e.currentEl=a;var i=e.placeholder.parentNode;if(i){i.insertBefore(a,e.placeholder.nextSibling);try{M(a),$(a),K(a)}catch(e){console.error("extra.js: x-if render error:",e)}}}}function J(e){var t=p.get(e);if(t)for(var r=0;r<t.length;r++)I(t[r])}function I(e){var t=!!g(S,e.parts);e.el.hidden=!t}function P(e){var t=v.get(e.topKey);t||v.set(e.topKey,t=[]),t.push(e),R(e)}function W(e){var t=v.get(e);if(t)for(var r=0;r<t.length;r++)R(t[r])}function R(e){var t=g(S,e.parts);!function(e,t,r){if(null!=r&&!1!==r)if(!0!==r){if(t in e)try{e[t]=r}catch(e){}e.setAttribute(t,r+"")}else{if(t in e)try{e[t]=!0}catch(e){}e.setAttribute(t,"")}else{if(t in e)try{"boolean"==typeof e[t]&&(e[t]=!1)}catch(e){}e.removeAttribute(t)}}(e.el,e.attr,t)}const _=new Map;function q(e,t,r){if(r){var n=r.trim();if(n){var o=t+"::"+n,a=_.get(o);if(!a)try{a=Function("el","event","x","store",`\n            return (async function () {\n              with (el) {\n                ${n}\n              }\n            }).call(el);\n          `),_.set(o,a)}catch(r){return void console.error("extra.js: x-on compile error for",t,"on element:",e,r)}e.addEventListener(t,function(r){try{var n=a(e,r,window.x,S);n&&"function"==typeof n.catch&&n.catch(function(r){console.error("extra.js: x-on async error for",t,"on element:",e,r)})}catch(r){console.error("extra.js: x-on runtime error for",t,"on element:",e,r)}})}}}function D(e,t,r){return e.replace(/\(\(\s*([^()]+)\s*\)\)/g,function(e,n){var o=n.trim();if(!o)return"";if(o===t||o.startsWith(t+".")||o.startsWith(t+"[")){var a=o.slice(t.length);if(!a)return null==r?"":r+"";var i=y("x"+a),s=r;if(i)for(var l=1;l<i.length&&null!=s;l++)s=s[i[l]];else s=void 0;return null==s?"":s+""}var c=y(o);if(!c)return"";var u=g(S,c);return null==u?"":u+""})}function F(e){var t=x.get(e);if(t)for(var r=0;r<t.length;r++)z(t[r])}function z(e){var t=g(S,e.parts);Array.isArray(t)||(t=[]);var r=e.el;r.innerHTML="";for(var n=0;n<t.length;n++){var o=t[n],a=D(e.templateHTML,e.varName,o);r.insertAdjacentHTML("beforeend",a)}try{$(r),K(r)}catch(e){console.error("extra.js: x-for render error:",e)}}function $(e){var t=e||document.body||document;if(t){var r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT),n=t instanceof Element?t:r.nextNode();for(t instanceof Element&&B(t);n=r.nextNode();)B(n)}}function B(e){if(e instanceof Element&&!e[h]){var t=e.hasAttribute("x-if"),r=e.hasAttribute("x-else"),n=e.hasAttribute("x-show"),o=e.hasAttribute("x-for");if(t){var a=e.getAttribute("x-if")||"";e.removeAttribute("x-if");var i=y(a);if(i){var s=i[0]+"",l=document.createComment("x-if:"+a),c=e.parentNode;c&&c.insertBefore(l,e);var u=null,f=e.nextElementSibling;f&&f.hasAttribute("x-else")&&(f.removeAttribute("x-else"),u=f,f.parentNode&&f.parentNode.removeChild(f),f[h]=!0),e.parentNode&&e.parentNode.removeChild(e);var v={topKey:s,parts:i,placeholder:l,ifTemplate:e,elseTemplate:u,currentEl:null,currentKind:null};e[h]=!0,u&&(u[h]=!0),function(e){var t=d.get(e.topKey);t||d.set(e.topKey,t=[]),t.push(e),C(e)}(v)}else console.warn("extra.js: invalid x-if expression:",a,"on element:",e)}else r&&(console.warn("extra.js: x-else without a preceding x-if. Element:",e),e.removeAttribute("x-else"));if(n){var m=e.getAttribute("x-show")||"";e.removeAttribute("x-show");var g=y(m);g?function(e){var t=p.get(e.topKey);t||p.set(e.topKey,t=[]),t.push(e),I(e)}({el:e,parts:g,topKey:g[0]+""}):console.warn("extra.js: invalid x-show expression:",m,"on element:",e)}if(o){var b=e.getAttribute("x-for")||"";e.removeAttribute("x-for");var w=function(e){if("string"!=typeof e)return null;if(!(e=e.trim()))return null;var t=e.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s+in\s+(.+)$/);if(!t)return console.warn("extra.js: x-for: invalid expression (expected 'item in path'):",e),null;var r=t[1],n=y(t[2].trim());return n?{varName:r,parts:n,topKey:n[0]+""}:(console.warn("extra.js: x-for: invalid collection path in expression:",e),null)}(b);if(w){var A=e.innerHTML,j=function(e,t,r){var n=new Set;n.add(r);for(var o,a=/\(\(\s*([^()]+)\s*\)\)/g;o=a.exec(e);){var i=o[1].trim();if(i&&i!==t&&!i.startsWith(t+".")&&!i.startsWith(t+"[")){var s=y(i);s&&n.add(s[0]+"")}}return Array.from(n)}(A,w.varName,w.topKey);return v={el:e,varName:w.varName,parts:w.parts,topKey:w.topKey,templateHTML:A,depsKeys:j},e[h]=!0,void function(e){for(var t=e.depsKeys,r=0;r<t.length;r++){var n=t[r],o=x.get(n);o||x.set(n,o=[]),o.push(e)}z(e)}(v)}console.warn("extra.js: ignoring x-for with invalid expression:",b,"on element:",e)}for(var N=e.attributes,E=0;E<N.length;E++){var T=N[E];if(T){var S=T.name;if("x-bind:"===S.slice(0,7)){var M=S.slice(7);if(!M)continue;var O=T.value||"",H=y(O);if(!H){console.warn("extra.js: invalid x-bind expression:",O,"on element:",e);continue}P({el:e,attr:M,parts:H,topKey:H[0]+""})}}}for(var L=0;L<N.length;L++){var K=N[L];if(K){var k=K.name;if("x-on:"===k.slice(0,5)){var J=k.slice(5);if(!J){console.warn("extra.js: x-on without event name on element:",e);continue}q(e,J,K.value||"")}}}e[h]=!0}}const G=Symbol("xHttpBound"),U=Symbol("xHttpPollId"),Z=new Map;function V(e,t){if(!e)return null;const r=e;if(Z.has(r))return Z.get(r);let n=null;try{n=JSON.parse(e),n&&"object"==typeof n||(console.warn("ExtraJS x-http: "+t+" JSON must be an object literal:",e),n=null)}catch(r){console.error("ExtraJS x-http: failed to parse "+t+" JSON:",r,"value:",e),n=null}return Z.set(r,n),n}function X(e,t){const r={};if(!e||"object"!=typeof e)return r;for(const t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;const n=e[t];if("string"!=typeof n||"#"!==n[0]&&"["!==n[0])r[t]=n;else{const e=n,o=document.querySelector(e);if(!o){console.warn("ExtraJS x-http: selector '"+e+"' not found"),r[t]=null;continue}o instanceof HTMLInputElement||o instanceof HTMLTextAreaElement||o instanceof HTMLSelectElement?o instanceof HTMLInputElement&&("checkbox"===o.type||"radio"===o.type)?r[t]=!!o.checked:r[t]=o.value:r[t]=o.textContent}}return r}function Q(e){return e&&e.closest?e.closest("form"):null}function Y(e){const t=new URLSearchParams;if(!e)return t;const r=new FormData(e);for(const[e,n]of r.entries())t.append(e,n);return t}function ee(e,t){const r=t.toString();return r?e+(-1===e.indexOf("?")?"?":"&")+r:e}function te(e,t){if(!t)return e;let r=null;try{r=document.querySelector(t)}catch(r){console.error("ExtraJS x-http: invalid x-target selector:",t,"on element:",e,r)}return r||(console.warn("ExtraJS x-http: x-target selector '"+t+"' not found, using element itself."),e)}function re(e){if(!e)return null;let t=null;try{t=document.querySelector(e)}catch(t){console.error("ExtraJS x-http: invalid x-indicator selector:",e,t)}return t||null}function ne(e,t,r){if(!e)return;let n=e;switch((r||"inner").toLowerCase()){case"append":e.insertAdjacentHTML("beforeend",t);break;case"prepend":e.insertAdjacentHTML("afterbegin",t);break;case"before":e.insertAdjacentHTML("beforebegin",t),n=e.parentNode||e;break;case"after":e.insertAdjacentHTML("afterend",t),n=e.parentNode||e;break;case"outer":{const r=e.parentNode;e.outerHTML=t,n=r||null}break;default:e.innerHTML=t}try{n?le(n):e.parentNode?le(e.parentNode):le(document.body||document)}catch(e){console.error("ExtraJS x-http: error running x.apply after swap:",e)}}async function oe(e){if(!(e instanceof Element))return;const t=e._xHttpConfig||{},r=t.url||e.getAttribute("x-http");if(!r)return;const n=e.getAttribute("x-confirm");if(null!=n&&!window.confirm(n))return;const o=(t.method||e.getAttribute("x-method")||e.getAttribute("method")||"GET").toUpperCase(),a=(t.swap||e.getAttribute("x-swap")||"inner").toLowerCase(),i=t.successTarget||te(e,e.getAttribute("x-target")),s=t.errorTarget||(e.hasAttribute("x-target-error")?te(e,e.getAttribute("x-target-error")):i),l=t.indicatorEl||re(e.getAttribute("x-indicator")),c=e.hasAttribute("x-json"),u=e.hasAttribute("x-form");if(c&&u)return void console.error("ExtraJS x-http: cannot use both x-json and x-form on the same element.",e);let f=r,d=null,p=null;const v="GET"===o||"HEAD"===o;try{if(function(e){if(!e)return;const t=e.hasAttribute("hidden");e.dataset.xIndicatorWasHidden=t?"1":"0",t&&e.removeAttribute("hidden")}(l),c){const t=e.getAttribute("x-json");let r={};r=t&&t.trim()?X(V(t,"x-json")||{}):function(e){const t={};if(!e)return t;const r=new FormData(e);for(const[e,n]of r.entries())if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];Array.isArray(r)?r.push(n):t[e]=[r,n]}else t[e]=n;return t}(Q(e)),d=JSON.stringify(r),p="application/json"}else if(u){const t=e.getAttribute("x-form");let r;if(t&&t.trim()){const e=X(V(t,"x-form")||{});r=new URLSearchParams;for(const t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;const n=e[t];r.append(t,null==n?"":n+"")}}else r=Y(Q(e));v?f=ee(f,r):(d=r.toString(),p="application/x-www-form-urlencoded")}else{const t=Q(e);if(t){const e=Y(t);v?f=ee(f,e):(d=e.toString(),p="application/x-www-form-urlencoded")}}const t=new Headers;p&&t.set("Content-Type",p);const r=e.getAttribute("x-headers");if(r&&r.trim()){const e=V(r,"x-headers");if(e&&"object"==typeof e)for(const r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;const n=e[r];null!=n&&t.set(r,n+"")}}const n={method:o,headers:t};let x;v||null==d||(n.body=d);try{x=await fetch(f,n)}catch(e){return ne(s,"Error: NETWORK",a),void console.error("HTTP NETWORK "+o+" "+f,e)}const h=x.status,m=-1!==(x.headers.get("Content-Type")||"").toLowerCase().indexOf("application/json");if(h>=200&&h<400)ne(i,await x.text(),a);else if(m){let e=null;try{e=await x.json()}catch(e){}ne(s,"Error: "+h,a),console.error("Error: JSON response not supported by x-http; use x-js for structured errors."),console.error("HTTP "+h+" "+o+" "+f),null!==e&&console.error("Response JSON:",e)}else ne(s,await x.text(),a),console.error("HTTP "+h+" "+o+" "+f)}finally{(x=l)&&("1"===x.dataset.xIndicatorWasHidden&&x.setAttribute("hidden",""),delete x.dataset.xIndicatorWasHidden)}var x}function ae(e){if(!(e instanceof Element))return;if(!e.hasAttribute("x-http"))return;if(e[G])return;const t=e.getAttribute("x-http");if(!t)return void console.warn("ExtraJS x-http: x-http attribute is empty on element:",e);const r=(e.getAttribute("x-method")||e.getAttribute("method")||"GET").toUpperCase(),n=(e.getAttribute("x-swap")||"inner").toLowerCase(),o=e.getAttribute("x-target"),a=e.getAttribute("x-target-error"),i=e.getAttribute("x-indicator"),s=te(e,o),l=a?te(e,a):s,c=re(i);e._xHttpConfig={url:t,method:r,swap:n,successTarget:s,errorTarget:l,indicatorEl:c};const u=function(e){const t=(e.getAttribute("x-trigger")||"").trim();if(!t)return"FORM"===e.tagName?{type:"event",event:"submit",delay:0}:{type:"event",event:"click",delay:0};if("load"===t)return{type:"load",delay:0};if(t.startsWith("load:")){const e=parseInt(t.slice(5),10);return{type:"load",delay:isNaN(e)?0:e}}if(t.startsWith("every:")){const e=parseInt(t.slice(6),10);return{type:"poll",interval:isNaN(e)?1e3:e}}const r=t.split(":"),n=r[0];if(r.length>1){const e=parseInt(r[1],10);return{type:"event",event:n,delay:isNaN(e)?0:e}}return{type:"event",event:t,delay:0}}(e);if("poll"===u.type){const t=u.interval||1e3,r=setInterval(function(){oe(e)},t);e[U]=r}else if("load"===u.type){const t=u.delay||0;t>0?setTimeout(function(){oe(e)},t):Promise.resolve().then(function(){oe(e)})}else if("event"===u.type)if(u.delay&&u.delay>0){let t=null;const r=function(r){r&&u&&"submit"===u.event&&r.preventDefault();const n=u.delay||0;null!=t&&clearTimeout(t),t=setTimeout(function(){oe(e)},n)};e.addEventListener(u.event,r)}else e.addEventListener(u.event,function(t){t&&u&&"submit"===u.event&&t.preventDefault(),oe(e)});e[G]=!0}function ie(e){const t=e||document.body||document;if(t&&(t instanceof Element&&t.hasAttribute("x-http")&&ae(t),t.querySelectorAll)){const e=t.querySelectorAll("[x-http]");for(let t=0;t<e.length;t++)ae(e[t])}}function se(e){if(!e)return;const t=e;if(t[U]&&(clearInterval(t[U]),delete t[U]),t.querySelectorAll){const e=t.querySelectorAll("[x-http]");for(let t=0;t<e.length;t++){const r=e[t];r[U]&&(clearInterval(r[U]),delete r[U])}}}function le(e){const t="string"==typeof e?document.getElementById(e)||document.querySelector(e)||document.body||document:e||document.body||document;t&&(K(t),ie(t))}function ce(){try{M(document.body||document,!0),$(document.body||document),function(){try{K(document)}catch(e){console.error("extra.js: initial x-js run failed:",e)}try{new MutationObserver(e=>{for(const t of e)if("attributes"===t.type&&"x-js"===t.attributeName&&t.target instanceof Element&&(delete t.target[H],L(t.target)),"childList"===t.type){if(t.removedNodes&&t.removedNodes.length)for(const e of t.removedNodes)1===e.nodeType&&se(e);if(t.addedNodes&&t.addedNodes.length)for(const e of t.addedNodes)if(1===e.nodeType)try{M(e),$(e),K(e),ie(e)}catch(e){console.error("extra.js: error while processing added nodes:",e)}}}).observe(document.body||document.documentElement,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["x-js"]})}catch(e){console.error("extra.js: failed to initialise MutationObserver:",e)}}(),ie(document.body||document)}catch(e){console.error("extra.js: init failed:",e)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",ce,{once:!0}):ce();var ue={config:{},store:S,watch:function(e,t){var r=y(e);if(r&&"function"==typeof t){var n=r[0]+"",o=l.get(n);o||l.set(n,o=[]),o.push({parts:r,fn:t,last:void 0,inited:!1})}else console.warn("extra.js: x.watch: invalid arguments, expected (pathString, function). Got:",e,t)},computed:function(e,t){e&&"string"==typeof e&&"function"==typeof t?c[e]={name:e,fn:t,deps:new Set,value:void 0,dirty:!0}:console.warn("extra.js: x.computed: invalid arguments, expected (string, function). Got:",e,t)},apply:le};window.x=ue,window.extra=ue}();